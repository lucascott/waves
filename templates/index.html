<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="{{ site_description }}">
    <meta name="theme-color" content="#000000">
    <meta name="color-scheme" content="dark">
    <title>{{ site_title }}</title>

    <!-- Open Graph / Social Media -->
    <meta property="og:url" content="{{ request.base_url }}"/>
    <meta property="og:type" content="website"/>
    <meta property="og:site_name" content="{{ site_title }}"/>
    <meta property="og:title" content="{{ site_title }}"/>
    <meta property="og:description" content="{{ site_description }}"/>
    <meta property="og:image" content="{{ request.base_url }}/static/images/artwork_placeholder.webp"/>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">

    <!-- Preconnect to font services -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Stylesheets -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/custom.css"/>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com/3.4.17?plugins=typography"></script>
</head>
<body class="bg-black text-white">
    <header class="sticky top-0 z-50 backdrop-blur">
        <div class="max-w-6xl mx-auto px-3 sm:px-4 md:px-8 py-3">
            <h1 class="text-2xl sm:text-4xl md:text-5xl lg:text-6xl font-light">{{ site_title }}</h1>
            <div class="text-neutral-500 text-xl mt-1 sm:mt-2 tracking-widest">✴ ✴ ✴ ✴</div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-3 sm:px-4 md:px-8 pt-8 sm:pt-12 pb-8">
        <section id="mixes" class="space-y-6 sm:space-y-8 md:space-y-16">
            {% for set in sets_list %}
                <article>
                    <div id="{{ set.id }}" style="position:relative;top:-300px"></div>

                    <div class="flex flex-col md:flex-row gap-4 sm:gap-6 md:gap-12 lg:gap-16 items-start w-full">
                        <!-- Artwork -->
                        <div class="flex justify-center md:justify-start mx-auto md:mx-0 flex-shrink-0">
                            <img src="{{ set.artwork_path }}" alt="artwork for {{ set.name or set.id }}" class="w-40 h-40 sm:w-56 sm:h-56 md:w-72 md:h-72 lg:w-96 lg:h-96 aspect-square object-cover object-top rounded-lg"/>
                        </div>

                        <!-- Content -->
                        <div class="w-full md:flex-1 flex flex-col min-w-0 space-y-6">
                            <!-- Title -->
                            <div>
                                <div class="flex items-center gap-3 mb-1 md:mb-2">
                                    <div class="text-neutral-500 text-xs tracking-widest">► MIX ◄</div>
                                    <button class="share-btn text-neutral-600 hover:text-white transition-colors" data-id="{{ set.id }}" title="Copy link">
                                        <i class="material-icons text-sm">link</i>
                                    </button>
                                </div>
                                <h2 class="text-xl sm:text-2xl md:text-4xl lg:text-5xl font-light text-white break-words">
                                    {{ set.name or set.id }}
                                </h2>

                                {% if set.description %}
                                <div class="prose prose-invert prose-p:text-neutral-400 prose-a:text-white mt-4 max-w-none">
                                    {{ set.description | safe }}
                                </div>
                                {% endif %}

                                {% if set.tags %}
                                <div class="flex flex-wrap gap-2 mt-4">
                                    {% for tag in set.tags %}
                                    <span class="px-3 py-1 bg-neutral-900 border border-neutral-800 text-neutral-400 text-xs font-mono rounded-full">{{ tag }}</span>
                                    {% endfor %}
                                </div>
                                {% endif %}
                            </div>

                            <!-- Waveform -->
                            <div id="{{ set.id }}-waveform" class="waveform relative rounded-lg overflow-hidden w-full h-full">
                                <div id="{{ set.id }}-time" class="absolute left-1 sm:left-2 md:left-3 top-1/2 -translate-y-1/2 z-20 text-xs md:text-sm lg:text-base text-white font-bold whitespace-nowrap">0:00</div>
                                <div id="{{ set.id }}-duration" class="absolute right-1 sm:right-2 md:right-3 top-1/2 -translate-y-1/2 z-20 text-xs md:text-sm lg:text-base text-white font-bold whitespace-nowrap">0:00</div>
                                <div id="{{ set.id }}-hover" class="hover-overlay absolute inset-0 pointer-events-none rounded-lg opacity-0"></div>
                            </div>

                            <!-- Play Button & Tracklist Toggle -->
                            <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-4">
                                <button id="{{ set.id }}-button" class="w-full sm:w-40 bg-gray-200 text-black font-bold text-sm py-3 px-3 rounded-lg flex items-center justify-center gap-2 hover:bg-white transition-colors flex-shrink-0">
                                    <i class="material-icons text-sm sm:text-base">play_arrow</i>
                                    <span>PLAY</span>
                                </button>

                                {% if set.tracklist %}
                                <div class="relative self-center sm:self-auto">
                                    <button id="{{ set.id }}-tracklist-toggle" class="text-xs text-neutral-500 hover:text-white tracking-widest transition-colors focus:outline-none flex items-center gap-2 py-2 sm:py-0">
                                        <span>TRACKLIST</span>
                                        <i class="material-icons text-xs">expand_more</i>
                                    </button>

                                    <div id="{{ set.id }}-tracklist" class="hidden absolute top-full left-1/2 -translate-x-1/2 sm:translate-x-0 sm:left-0 mt-2 z-40 bg-neutral-900 border border-neutral-800 rounded-lg shadow-xl p-4 min-w-[280px] max-w-[90vw] sm:max-w-md max-h-96 overflow-y-auto">
                                        <ul class="text-sm text-neutral-400 space-y-2 list-none p-0 m-0 font-mono">
                                            {% for track in set.tracklist %}
                                            <li class="break-words border-b border-neutral-800 last:border-0 pb-2 last:pb-0">{{ track }}</li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Divider -->
                    {% if not loop.last %}
                    <div class="mt-6 sm:mt-8 md:mt-16 text-center text-neutral-500 text-xs tracking-widest">～ ◇ ～ ◇ ～</div>
                    {% endif %}
                </article>
            {% endfor %}
        </section>

        {% if outro_section.has_content() %}
        <!-- Outro section -->
        <section class="mt-16 md:mt-24">
            <div class="text-center mx-auto">
                <div class="text-neutral-500 text-xs mb-4 tracking-widest">(｡◕‿‿◕｡)</div>
                <h2 class="text-2xl md:text-4xl font-light mb-4 text-white">{{ outro_section.title }}</h2>
                <p class="text-neutral-400 text-lg md:text-xl mb-6">{{ outro_section.description }}</p>
                {% if outro_section.link_url %}
                <a href="{{ outro_section.link_url }}" target="_blank" class="special inline-block px-4 py-3 border border-white text-white rounded-lg text-sm md:text-lg font-bold hover:bg-white hover:text-black transition-colors">
                    {{ outro_section.normalized_link_text() }}
                </a>
                {% endif %}
            </div>
        </section>
        {% endif %}
    </main>

    <footer class="mt-2 mb-16 md:mb-24">
        <div class="max-w-6xl mx-auto px-3 py-8 text-center">
            <div class="text-neutral-500 text-xs mb-2 tracking-widest">◆ ◇ ◆</div>
            <p class="text-neutral-500 text-xs sm:text-sm">‧✧˚✴ {{ site_footer }} ✴˚✧‧</p>
        </div>
    </footer>

    <!-- Bottom Player -->
    <div id="bottom-player" class="fixed bottom-0 left-0 right-0 w-full bg-neutral-950 hidden z-50">
        <div class="max-w-6xl mx-auto px-2 sm:px-4 md:px-6 py-2 md:py-3 flex items-center justify-between gap-2 sm:gap-4">
            <div class="flex items-center gap-2 sm:gap-3 min-w-0 flex-1">
                <img id="player-artwork" src="" alt="Now playing" class="w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10 object-cover hidden rounded flex-shrink-0"/>
                <div class="min-w-0 flex-1">
                    <div id="player-title" class="text-white text-xs md:text-sm truncate font-medium cursor-pointer hover:underline">-</div>
                    <div id="player-time" class="text-neutral-500 text-xs block">0:00 / 0:00</div>
                </div>
            </div>
            <button id="player-btn" class="bg-gray-200 text-black p-1.5 sm:p-2 md:p-3 hover:bg-white transition-colors flex-shrink-0 flex items-center justify-center rounded">
                <i class="material-icons text-base md:text-lg">play_arrow</i>
            </button>
        </div>
        <div class="h-1 bg-white" id="player-progress" style="width: 0"></div>
    </div>

    <script src="https://unpkg.com/wavesurfer.js@7"></script>
    <script>
        const setsList = {{ sets_list | tojson }};
    </script>
    <script src="../static/custom.js"></script>
</body>
</html>
